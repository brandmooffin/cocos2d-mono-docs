"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[82070],{28453:(e,n,r)=>{r.d(n,{RP:()=>a});var i=r(96540);const t=i.createContext({});function a(e){const n=i.useContext(t);return i.useMemo(()=>"function"==typeof e?e(n):{...n,...e},[n,e])}},69745:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>l,contentTitle:()=>o,default:()=>p,frontMatter:()=>a,metadata:()=>s,toc:()=>d});var i=r(74848),t=r(28453);const a={sidebar_position:4},o="Part 3: Player Character",s={id:"tutorials/platformer-tutorial/part-3-player",title:"Part 3: Player Character",description:"In this part, we'll create our player character with movement controls, animations, and physics integration.",source:"@site/docs/tutorials/platformer-tutorial/part-3-player.md",sourceDirName:"tutorials/platformer-tutorial",slug:"/tutorials/platformer-tutorial/part-3-player",permalink:"/docs/tutorials/platformer-tutorial/part-3-player",draft:!1,unlisted:!1,tags:[],version:"current",sidebarPosition:4,frontMatter:{sidebar_position:4},sidebar:"tutorials",previous:{title:"Part 2: Physics Foundation",permalink:"/docs/tutorials/platformer-tutorial/part-2-physics"},next:{title:"Part 4: Platforms and Collision",permalink:"/docs/tutorials/platformer-tutorial/part-4-platforms"}},l={},d=[{value:"What We&#39;ll Accomplish",id:"what-well-accomplish",level:2},{value:"Prerequisites",id:"prerequisites",level:2},{value:"Step 1: Player Character Assets",id:"step-1-player-character-assets",level:2},{value:"Step 2: Create Player Class",id:"step-2-create-player-class",level:2},{value:"Step 3: Integrating Player into Game",id:"step-3-integrating-player-into-game",level:2},{value:"\ud83c\udfaf Checkpoint: Controllable Character",id:"-checkpoint-controllable-character",level:2},{value:"Troubleshooting",id:"troubleshooting",level:2},{value:"Next Steps",id:"next-steps",level:2},{value:"Complete Code Reference",id:"complete-code-reference",level:2}];function c(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,t.RP)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.h1,{id:"part-3-player-character",children:"Part 3: Player Character"}),"\n",(0,i.jsx)(n.p,{children:"In this part, we'll create our player character with movement controls, animations, and physics integration."}),"\n",(0,i.jsx)(n.h2,{id:"what-well-accomplish",children:"What We'll Accomplish"}),"\n",(0,i.jsx)(n.p,{children:"By the end of this part, you'll have:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"A controllable player character"}),"\n",(0,i.jsx)(n.li,{children:"Basic movement with arrow keys or WASD"}),"\n",(0,i.jsx)(n.li,{children:"Sprite animations for idle, walking, and jumping"}),"\n",(0,i.jsx)(n.li,{children:"Physics-based movement using Box2D"}),"\n",(0,i.jsx)(n.li,{children:"Proper character collision detection"}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"prerequisites",children:"Prerequisites"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Completed ",(0,i.jsx)(n.a,{href:"./part-2-physics",children:"Part 2: Physics Foundation"})]}),"\n",(0,i.jsx)(n.li,{children:"Understanding of sprite animations"}),"\n",(0,i.jsx)(n.li,{children:"Basic input handling concepts"}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"step-1-player-character-assets",children:"Step 1: Player Character Assets"}),"\n",(0,i.jsx)(n.p,{children:"For this tutorial, we'll need the following sprite assets:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"player_idle.png"})," - Idle animation frames"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"player_run_1.png"}),", ",(0,i.jsx)(n.code,{children:"player_run_2.png"}),", ",(0,i.jsx)(n.code,{children:"player_run_3.png"}),", ",(0,i.jsx)(n.code,{children:"player_run_4.png"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Running animation frames"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"player_jump.png"})," - Jumping frame"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"jump.wav"})," - Jumping sound"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"land.wav"})," - Landing sound"]}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:["You can find these assets in the ",(0,i.jsx)(n.a,{href:"https://github.com/brandmooffin/cocos2d-mono-samples/tree/main/Tutorial%20Samples/Platformer/Final/Platformer/Content",children:"complete project reference"}),"."]}),"\n",(0,i.jsx)(n.p,{children:'Add these files to your Content folder and ensure they\'re set to "Content" build action.'}),"\n",(0,i.jsx)(n.h2,{id:"step-2-create-player-class",children:"Step 2: Create Player Class"}),"\n",(0,i.jsxs)(n.p,{children:["Create a new file called ",(0,i.jsx)(n.code,{children:"Player.cs"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-csharp",children:'using System;\r\nusing Cocos2D;\r\nusing Box2D.Dynamics;\r\nusing Box2D.Common;\r\nusing Box2D.Collision.Shapes;\r\nusing CocosDenshion;\r\n\r\nnamespace Platformer\r\n{\r\n    public class Player : CCSprite\r\n    {\r\n        // Physics body\r\n        private b2Body _body;\r\n\r\n        // Movement parameters\r\n        private const float MOVE_SPEED = 5.0f;\r\n        private const float JUMP_FORCE = 7.0f;\r\n        private bool _canJump = false;\r\n        private int _jumpCount = 0;\r\n        private const int MAX_JUMPS = 2; // Allow double jump\r\n        private bool _isRunning = false;\r\n\r\n        // Animation states\r\n        private CCAnimation _idleAnimation;\r\n        private CCAnimation _runAnimation;\r\n        private CCAnimation _jumpAnimation;\r\n\r\n        public Player(b2World world) : base("player_idle")\r\n        {\r\n            // Create physics body\r\n            b2BodyDef bodyDef = new b2BodyDef();\r\n            bodyDef.type = b2BodyType.b2_dynamicBody;\r\n            bodyDef.fixedRotation = true; // Prevent rotation\r\n            bodyDef.allowSleep = false;\r\n\r\n            _body = world.CreateBody(bodyDef);\r\n\r\n            // Create fixture\r\n            b2PolygonShape shape = new b2PolygonShape();\r\n            // Make the collision box slightly smaller than the sprite\r\n            shape.SetAsBox(\r\n                ContentSize.Width * 0.4f / PhysicsHelper.PTM_RATIO,\r\n                ContentSize.Height * 0.45f / PhysicsHelper.PTM_RATIO);\r\n\r\n            b2FixtureDef fixtureDef = new b2FixtureDef();\r\n            fixtureDef.shape = shape;\r\n            fixtureDef.density = 1.0f;\r\n            fixtureDef.friction = 0.2f;\r\n            fixtureDef.restitution = 0.0f;\r\n\r\n            // Set collision filtering\r\n            fixtureDef.filter.categoryBits = PhysicsHelper.CATEGORY_PLAYER;\r\n            fixtureDef.filter.maskBits = PhysicsHelper.CATEGORY_PLATFORM | PhysicsHelper.CATEGORY_COLLECTIBLE;\r\n\r\n            _body.CreateFixture(fixtureDef);\r\n\r\n            // Add foot sensor for jump detection\r\n            b2PolygonShape footShape = new b2PolygonShape();\r\n            footShape.SetAsBox(\r\n                ContentSize.Width * 0.3f / PhysicsHelper.PTM_RATIO,\r\n                0.1f / PhysicsHelper.PTM_RATIO,\r\n                new b2Vec2(0, -ContentSize.Height * 0.45f / PhysicsHelper.PTM_RATIO),\r\n                0);\r\n\r\n            b2FixtureDef footFixtureDef = new b2FixtureDef();\r\n            footFixtureDef.shape = footShape;\r\n            footFixtureDef.isSensor = true;\r\n\r\n            b2Fixture footSensor = _body.CreateFixture(footFixtureDef);\r\n            footSensor.UserData = new FootSensorUserData(this);\r\n\r\n            // Load animations\r\n            LoadAnimations();\r\n        }\r\n\r\n        private void LoadAnimations()\r\n        {\r\n            // In a real game, you would load animation frames\r\n            // For this tutorial, we\'ll use placeholder logic\r\n\r\n            _idleAnimation = new CCAnimation();\r\n            // Add frames to animation\r\n            _idleAnimation.AddSpriteFrameWithFileName("player_idle");\r\n            _idleAnimation.DelayPerUnit = 0.2f;\r\n\r\n            _runAnimation = new CCAnimation();\r\n            // Add multiple frames for run animation\r\n            _runAnimation.AddSpriteFrameWithFileName("player_run_1");\r\n            _runAnimation.AddSpriteFrameWithFileName("player_run_2");\r\n            _runAnimation.AddSpriteFrameWithFileName("player_run_3");\r\n            _runAnimation.AddSpriteFrameWithFileName("player_run_4");\r\n            _runAnimation.DelayPerUnit = 0.1f;\r\n\r\n            _jumpAnimation = new CCAnimation();\r\n            _jumpAnimation.AddSpriteFrameWithFileName("player_jump");\r\n            _jumpAnimation.DelayPerUnit = 0.1f;\r\n        }\r\n\r\n        public void Update(float dt)\r\n        {\r\n            // Update sprite position based on physics body\r\n            Position = PhysicsHelper.ToCocosVector(_body.Position);\r\n\r\n            // Check if player fell off the screen\r\n            if (Position.Y < -100)\r\n            {\r\n                // Reset position\r\n                _body.SetTransform(new b2Vec2(100 / PhysicsHelper.PTM_RATIO, 300 / PhysicsHelper.PTM_RATIO), 0);\r\n                _body.LinearVelocity = b2Vec2.Zero;\r\n            }\r\n        }\r\n\r\n        public void MoveLeft()\r\n        {\r\n            _body.LinearVelocity = new b2Vec2(-MOVE_SPEED, _body.LinearVelocity.y);\r\n\r\n            // Flip sprite to face left\r\n            FlipX = true;\r\n\r\n            // Play run animation if on ground\r\n            if (_canJump && _jumpCount == 0 && !_isRunning)\r\n            {\r\n                _isRunning = true; // Set running state\r\n                RunAction(new CCRepeatForever(new CCAnimate(_runAnimation)));\r\n            }\r\n        }\r\n\r\n        public void MoveRight()\r\n        {\r\n            _body.LinearVelocity = new b2Vec2(MOVE_SPEED, _body.LinearVelocity.y);\r\n\r\n            // Flip sprite to face right\r\n            FlipX = false;\r\n\r\n            // Play run animation if on ground\r\n            if (_canJump && _jumpCount == 0 && !_isRunning)\r\n            {\r\n                _isRunning = true; // Set running state\r\n                RunAction(new CCRepeatForever(new CCAnimate(_runAnimation)));\r\n            }\r\n        }\r\n\r\n        public void StopMoving()\r\n        {\r\n            _body.LinearVelocity = new b2Vec2(0, _body.LinearVelocity.y);\r\n\r\n            // Play idle animation if on ground\r\n            if (_canJump && _jumpCount == 0)\r\n            {\r\n                _isRunning = false; // Stop running animation\r\n                StopAllActions();\r\n                RunAction(new CCRepeatForever(new CCAnimate(_idleAnimation)));\r\n            }\r\n        }\r\n\r\n        public void Jump()\r\n        {\r\n            if (_canJump && _jumpCount < MAX_JUMPS)\r\n            {\r\n                _body.LinearVelocity = new b2Vec2(_body.LinearVelocity.x, JUMP_FORCE);\r\n                _jumpCount++;\r\n                _canJump = (_jumpCount < MAX_JUMPS);\r\n\r\n                _isRunning = false; // Stop running animation when jumping\r\n                // Play jump animation\r\n                StopAllActions();\r\n                RunAction(new CCAnimate(_jumpAnimation));\r\n\r\n                // Play jump sound\r\n                PlayJumpSound();\r\n            }\r\n        }\r\n\r\n        public void SetCanJump(bool canJump)\r\n        {\r\n            if (canJump && !_canJump)\r\n            {\r\n                // Player just landed\r\n                _jumpCount = 0;\r\n\r\n                // Play landing sound\r\n                PlayLandSound();\r\n\r\n                // Play idle or run animation based on horizontal velocity\r\n                StopAllActions();\r\n\r\n                if (Math.Abs(_body.LinearVelocity.x) > 0.1f)\r\n                {\r\n                    RunAction(new CCRepeatForever(new CCAnimate(_runAnimation)));\r\n                }\r\n                else\r\n                {\r\n                    RunAction(new CCRepeatForever(new CCAnimate(_idleAnimation)));\r\n                }\r\n            }\r\n\r\n            _canJump = canJump;\r\n        }\r\n\r\n        private void PlayJumpSound()\r\n        {\r\n            CCSimpleAudioEngine.SharedEngine.PlayEffect("jump");\r\n        }\r\n\r\n        private void PlayLandSound()\r\n        {\r\n            CCSimpleAudioEngine.SharedEngine.PlayEffect("land");\r\n        }\r\n\r\n        // User data for foot sensor\r\n        public class FootSensorUserData\r\n        {\r\n            public Player Player { get; private set; }\r\n\r\n            public FootSensorUserData(Player player)\r\n            {\r\n                Player = player;\r\n            }\r\n        }\r\n\r\n    }\r\n}\n'})}),"\n",(0,i.jsx)(n.h2,{id:"step-3-integrating-player-into-game",children:"Step 3: Integrating Player into Game"}),"\n",(0,i.jsxs)(n.p,{children:["Update your ",(0,i.jsx)(n.code,{children:"GameLayer.cs"})," to add the player, handle keyboard input & load sounds:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-csharp",children:'using System;\r\nusing System.Collections.Generic;\r\nusing Cocos2D;\r\nusing Box2D.Dynamics;\r\nusing Box2D.Common;\r\nusing Box2D.Dynamics.Contacts;\r\nusing Box2D.Collision;\r\nusing Microsoft.Xna.Framework.Input;\r\nusing CocosDenshion;\r\n\r\nnamespace Platformer\r\n{\r\n    public class GameLayer : CCLayer\r\n    {\r\n        // Box2D world\r\n        private b2World _world;\r\n\r\n        // Game objects\r\n        private Player _player;\r\n\r\n        // Input state\r\n        private bool _isLeftPressed;\r\n        private bool _isRightPressed;\r\n        private bool _isJumpPressed;\r\n        \r\n        private int _score = 0;\r\n        private CCLabelTTF _scoreLabel;\r\n        private CCMenuItemLabel _restartButton;\r\n\r\n        public GameLayer()\r\n        {\r\n            // Initialize physics world with gravity\r\n            _world = new b2World(new b2Vec2(0, -10.0f));\r\n\r\n            // Create level\r\n            CreateLevel();\r\n\r\n            // Load sounds\r\n            CCSimpleAudioEngine.SharedEngine.PreloadEffect("jump");\r\n            CCSimpleAudioEngine.SharedEngine.PreloadEffect("land");\r\n\r\n            ScheduleUpdate();\r\n        }\r\n\r\n        private void CreateLevel()\r\n        {\r\n            // Get visible area size\r\n            CCSize visibleSize = CCDirector.SharedDirector.WinSize;\r\n\r\n            // Create background\r\n            CCSprite background = new CCSprite("background");\r\n            background.Position = new CCPoint(visibleSize.Width / 2, visibleSize.Height / 2);\r\n            background.Scale = Math.Max(visibleSize.Width / background.ContentSize.Width,\r\n                                       visibleSize.Height / background.ContentSize.Height);\r\n            AddChild(background, -1);\r\n\r\n            // Create player\r\n            _player = new Player(_world);\r\n            _player.Position = new CCPoint(100, 300);\r\n            AddChild(_player);\r\n\r\n            // Create score label\r\n            _scoreLabel = new CCLabelTTF($"Score: {_score}", "MarkerFelt", 22);\r\n            _scoreLabel.Position = new CCPoint(100, visibleSize.Height - 30);\r\n            _scoreLabel.Color = CCColor3B.Black;\r\n            AddChild(_scoreLabel, 10);\r\n\r\n            // Create restart button\r\n            CCLabelTTF restartLabel = new CCLabelTTF("Restart", "MarkerFelt", 22);\r\n            restartLabel.Color = CCColor3B.Black;\r\n            _restartButton = new CCMenuItemLabel(restartLabel, RestartGame);\r\n            _restartButton.Position = new CCPoint(visibleSize.Width - 100, visibleSize.Height - 30);\r\n\r\n            CCMenu menu = new CCMenu(_restartButton);\r\n            menu.Position = CCPoint.Zero;\r\n            AddChild(menu, 10);\r\n        }\r\n\r\n        private void RestartGame(object sender)\r\n        {\r\n            // Reset score\r\n            _score = 0;\r\n\r\n            RemoveAllChildren();\r\n            CreateLevel();\r\n        }\r\n\r\n        public void IncreaseScore(int points)\r\n        {\r\n            _score += points;\r\n            _scoreLabel.Text = $"Score: {_score}";\r\n        }\r\n\r\n        public override void Update(float dt)\r\n        {\r\n            // Update physics world\r\n            _world.Step(dt, 8, 3);\r\n\r\n            // Update player movement based on input\r\n            if (_isLeftPressed)\r\n                _player.MoveLeft();\r\n            else if (_isRightPressed)\r\n                _player.MoveRight();\r\n            else\r\n                _player.StopMoving();\r\n\r\n            if (_isJumpPressed)\r\n                _player.Jump();\r\n\r\n            // Update all game objects\r\n            _player.Update(dt);\r\n\r\n            base.Update(dt);\r\n\r\n            // Handle keyboard state every frame            \r\n            HandleInput();\r\n        }\r\n\r\n        public void HandleInput()\r\n        {\r\n            // Reset input state\r\n            _isLeftPressed = false;\r\n            _isRightPressed = false;\r\n            _isJumpPressed = false;\r\n\r\n            // Handle keyboard input\r\n            KeyboardState state = Keyboard.GetState();\r\n            if (state.IsKeyDown(Keys.Left))\r\n                _isLeftPressed = true;\r\n            if (state.IsKeyDown(Keys.Right))\r\n                _isRightPressed = true;\r\n            if (state.IsKeyDown(Keys.Space))\r\n                _isJumpPressed = true;\r\n        }\r\n    }\r\n}\n'})}),"\n",(0,i.jsx)(n.h2,{id:"-checkpoint-controllable-character",children:"\ud83c\udfaf Checkpoint: Controllable Character"}),"\n",(0,i.jsx)(n.p,{children:"At this point, you should have:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"\u2705 A player character that responds to keyboard input"}),"\n",(0,i.jsx)(n.li,{children:"\u2705 Physics-based movement with Box2D"}),"\n",(0,i.jsx)(n.li,{children:"\u2705 Basic sprite animation system"}),"\n",(0,i.jsx)(n.li,{children:"\u2705 Character that can move left/right and has jump input"}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Test your game"}),": Run the project and verify that:"]}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsx)(n.li,{children:"The player character appears on screen"}),"\n",(0,i.jsx)(n.li,{children:"Arrow keys or WASD move the character left/right"}),"\n",(0,i.jsx)(n.li,{children:"Spacebar or Up arrow makes the character jump"}),"\n",(0,i.jsx)(n.li,{children:"The character sprite flips when changing direction"}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"troubleshooting",children:"Troubleshooting"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Character not moving"}),": Check that keyboard input events are properly set up and the physics body is created correctly."]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Character moving too fast/slow"}),": Adjust the ",(0,i.jsx)(n.code,{children:"MovementSpeed"})," and ",(0,i.jsx)(n.code,{children:"JumpForce"})," properties in the Player class."]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Animations not working"}),': Ensure sprite assets are properly added to the Content folder with "Content" build action.']}),"\n",(0,i.jsx)(n.h2,{id:"next-steps",children:"Next Steps"}),"\n",(0,i.jsxs)(n.p,{children:["In ",(0,i.jsx)(n.a,{href:"./part-4-platforms",children:"Part 4: Platforms and Collision"}),", we'll create platforms for the player to jump on and implement proper collision detection."]}),"\n",(0,i.jsx)(n.h2,{id:"complete-code-reference",children:"Complete Code Reference"}),"\n",(0,i.jsxs)(n.p,{children:["You can find the complete code for this part in the ",(0,i.jsx)(n.a,{href:"https://github.com/brandmooffin/cocos2d-mono-samples/tree/main/Tutorial%20Samples/Platformer/Checkpoints/Part%203",children:"tutorial samples repository"}),"."]})]})}function p(e={}){const{wrapper:n}={...(0,t.RP)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(c,{...e})}):c(e)}}}]);