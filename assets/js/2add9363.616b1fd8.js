"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[38437],{3059:(e,t,r)=>{r.r(t),r.d(t,{assets:()=>a,contentTitle:()=>s,default:()=>p,frontMatter:()=>l,metadata:()=>i,toc:()=>c});var n=r(74848),o=r(28453);const l={sidebar_position:5},s="Part 4: Platforms and Collision",i={id:"tutorials/platformer-tutorial/part-4-platforms",title:"Part 4: Platforms and Collision",description:"In this part, we'll create platforms for our player to jump on and implement proper collision detection between the player and platform objects.",source:"@site/docs/tutorials/platformer-tutorial/part-4-platforms.md",sourceDirName:"tutorials/platformer-tutorial",slug:"/tutorials/platformer-tutorial/part-4-platforms",permalink:"/docs/tutorials/platformer-tutorial/part-4-platforms",draft:!1,unlisted:!1,tags:[],version:"current",sidebarPosition:5,frontMatter:{sidebar_position:5},sidebar:"tutorials",previous:{title:"Part 3: Player Character",permalink:"/docs/tutorials/platformer-tutorial/part-3-player"},next:{title:"Part 5: Game Mechanics",permalink:"/docs/tutorials/platformer-tutorial/part-5-mechanics"}},a={},c=[{value:"What We&#39;ll Accomplish",id:"what-well-accomplish",level:2},{value:"Prerequisites",id:"prerequisites",level:2},{value:"Step 1: Platform Assets",id:"step-1-platform-assets",level:2},{value:"Step 2: Create Platform Class",id:"step-2-create-platform-class",level:2},{value:"Step 3: Collision Detection System",id:"step-3-collision-detection-system",level:2},{value:"Step 4: Level Creation",id:"step-4-level-creation",level:2},{value:"\ud83c\udfaf Checkpoint: Platforms and Collision",id:"-checkpoint-platforms-and-collision",level:2},{value:"Troubleshooting",id:"troubleshooting",level:2},{value:"Next Steps",id:"next-steps",level:2},{value:"Complete Code Reference",id:"complete-code-reference",level:2}];function d(e){const t={a:"a",code:"code",h1:"h1",h2:"h2",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,o.RP)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(t.h1,{id:"part-4-platforms-and-collision",children:"Part 4: Platforms and Collision"}),"\n",(0,n.jsx)(t.p,{children:"In this part, we'll create platforms for our player to jump on and implement proper collision detection between the player and platform objects."}),"\n",(0,n.jsx)(t.h2,{id:"what-well-accomplish",children:"What We'll Accomplish"}),"\n",(0,n.jsx)(t.p,{children:"By the end of this part, you'll have:"}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsx)(t.li,{children:"Platform objects with physics bodies"}),"\n",(0,n.jsx)(t.li,{children:"Collision detection between player and platforms"}),"\n",(0,n.jsx)(t.li,{children:"Proper ground detection for jumping"}),"\n",(0,n.jsx)(t.li,{children:"A basic level layout with multiple platforms"}),"\n",(0,n.jsx)(t.li,{children:"Contact listener for physics interactions"}),"\n"]}),"\n",(0,n.jsx)(t.h2,{id:"prerequisites",children:"Prerequisites"}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsxs)(t.li,{children:["Completed ",(0,n.jsx)(t.a,{href:"./part-3-player",children:"Part 3: Player Character"})]}),"\n",(0,n.jsx)(t.li,{children:"Understanding of Box2D collision detection"}),"\n",(0,n.jsx)(t.li,{children:"Basic knowledge of contact listeners"}),"\n"]}),"\n",(0,n.jsx)(t.h2,{id:"step-1-platform-assets",children:"Step 1: Platform Assets"}),"\n",(0,n.jsx)(t.p,{children:"For platforms, we'll need:"}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.code,{children:"platform.png"})," - Simple platform sprite"]}),"\n"]}),"\n",(0,n.jsxs)(t.p,{children:["Add these to your Content folder. You can find these assets in the ",(0,n.jsx)(t.a,{href:"https://github.com/brandmooffin/cocos2d-mono-samples/tree/main/Tutorial%20Samples/Platformer/Final/Platformer/Content",children:"complete project reference"}),"."]}),"\n",(0,n.jsx)(t.h2,{id:"step-2-create-platform-class",children:"Step 2: Create Platform Class"}),"\n",(0,n.jsxs)(t.p,{children:["Create a new file called ",(0,n.jsx)(t.code,{children:"Platform.cs"}),":"]}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-csharp",children:'using Cocos2D;\r\nusing Box2D.Dynamics;\r\n\r\nnamespace Platformer\r\n{\r\n    public class Platform : CCSprite\r\n    {\r\n        // Physics body\r\n        private b2Body _body;\r\n\r\n        public Platform(b2World world, float posX, float posY, float width, float height) : base("platform")\r\n        {\r\n            // Set position and scale to match desired dimensions\r\n            this.Position = new CCPoint(posX, posY);\r\n            this.ScaleX = width / this.ContentSize.Width;\r\n            this.ScaleY = height / this.ContentSize.Height;\r\n\r\n            // Create physics body\r\n            _body = PhysicsHelper.CreateBoxBody(\r\n                world,\r\n                posX,\r\n                posY,\r\n                width,\r\n                height,\r\n                false,  // Static body\r\n                1.0f,   // Density\r\n                0.3f,   // Friction\r\n                0.0f    // No bounce\r\n            );\r\n\r\n            // Set collision filtering\r\n            b2Fixture fixture = _body.FixtureList;\r\n            b2Filter filter = fixture.Filter;\r\n            filter.categoryBits = PhysicsHelper.CATEGORY_PLATFORM;\r\n            filter.maskBits = PhysicsHelper.CATEGORY_PLAYER;\r\n            fixture.SetFilterData(filter);\r\n\r\n            // Store reference to this platform\r\n            _body.UserData = this;\r\n        }\r\n    }\r\n}\n'})}),"\n",(0,n.jsx)(t.h2,{id:"step-3-collision-detection-system",children:"Step 3: Collision Detection System"}),"\n",(0,n.jsxs)(t.p,{children:["Create a contact listener to handle collisions. Create ",(0,n.jsx)(t.code,{children:"ContactListener.cs"}),":"]}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-csharp",children:"using Box2D.Collision;\r\nusing Box2D.Dynamics;\r\nusing Box2D.Dynamics.Contacts;\r\n\r\nnamespace Platformer\r\n{\r\n    public class ContactListener : b2ContactListener\r\n    {\r\n        public override void BeginContact(b2Contact contact)\r\n        {\r\n            // Check for foot sensor contacts to enable jumping\r\n            object userDataA = contact.GetFixtureA().UserData;\r\n            object userDataB = contact.GetFixtureB().UserData;\r\n\r\n            Player.FootSensorUserData footData = userDataA as Player.FootSensorUserData\r\n                                             ?? userDataB as Player.FootSensorUserData;\r\n\r\n            if (footData != null)\r\n            {\r\n                footData.Player.SetCanJump(true);\r\n            }\r\n        }\r\n\r\n        public override void EndContact(b2Contact contact)\r\n        {\r\n            // Check for foot sensor contacts to disable jumping\r\n            object userDataA = contact.GetFixtureA().UserData;\r\n            object userDataB = contact.GetFixtureB().UserData;\r\n\r\n            Player.FootSensorUserData footData = userDataA as Player.FootSensorUserData\r\n                                             ?? userDataB as Player.FootSensorUserData;\r\n\r\n            if (footData != null)\r\n            {\r\n                footData.Player.SetCanJump(false);\r\n            }\r\n        }\r\n\r\n        public override void PostSolve(b2Contact contact, ref b2ContactImpulse impulse)\r\n        {\r\n            \r\n        }\r\n\r\n        public override void PreSolve(b2Contact contact, b2Manifold oldManifold)\r\n        {\r\n            \r\n        }\r\n    }\r\n}\n"})}),"\n",(0,n.jsx)(t.h2,{id:"step-4-level-creation",children:"Step 4: Level Creation"}),"\n",(0,n.jsxs)(t.p,{children:["Update your ",(0,n.jsx)(t.code,{children:"GameLayer.cs"})," to create a level with platforms:"]}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-csharp",children:"private List<Platform> _platforms = new List<Platform>();\r\nprivate ContactListener contactListener;\r\n\r\nprotected override void AddedToScene()\r\n{\r\n    base.AddedToScene();\r\n\r\n    // ...existing code\r\n    \r\n    // Set up contact listener for collisions\r\n    contactListener = new ContactListener();\r\n    _world.SetContactListener(contactListener);\r\n    \r\n    // Create platforms\r\n    CreateLevel();\r\n\r\n    // ...existing code\r\n}\r\n\r\nprivate void CreateLevel()\r\n{\r\n    // ...existing code\r\n\r\n    // Create floor platform\r\n    Platform floor = new Platform(_world, visibleSize.Width / 2, 32, visibleSize.Width, 64);\r\n    _platforms.Add(floor);\r\n    AddChild(floor);\r\n\r\n    // Create some platforms\r\n    Platform platform1 = new Platform(_world, 200, 100, 200, 32);\r\n    _platforms.Add(platform1);\r\n    AddChild(platform1);\r\n\r\n    Platform platform2 = new Platform(_world, 600, 100, 200, 32);\r\n    _platforms.Add(platform2);\r\n    AddChild(platform2);\r\n}\n"})}),"\n",(0,n.jsx)(t.h2,{id:"-checkpoint-platforms-and-collision",children:"\ud83c\udfaf Checkpoint: Platforms and Collision"}),"\n",(0,n.jsx)(t.p,{children:"At this point, you should have:"}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsx)(t.li,{children:"\u2705 Multiple platforms that the player can stand on"}),"\n",(0,n.jsx)(t.li,{children:"\u2705 Proper collision detection between player and platforms"}),"\n",(0,n.jsx)(t.li,{children:"\u2705 Ground detection that allows jumping only when on platforms"}),"\n",(0,n.jsx)(t.li,{children:"\u2705 A basic level layout with different platform heights"}),"\n",(0,n.jsx)(t.li,{children:"\u2705 Smooth character movement and jumping"}),"\n"]}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"Test your game"}),": Run the project and verify that:"]}),"\n",(0,n.jsxs)(t.ol,{children:["\n",(0,n.jsx)(t.li,{children:"The player can walk on all platforms"}),"\n",(0,n.jsx)(t.li,{children:"The player can jump from platform to platform"}),"\n",(0,n.jsx)(t.li,{children:"The player cannot jump while in mid-air"}),"\n",(0,n.jsx)(t.li,{children:"Collision detection works smoothly without jittering"}),"\n",(0,n.jsx)(t.li,{children:"The player properly lands on platform surfaces"}),"\n"]}),"\n",(0,n.jsx)(t.h2,{id:"troubleshooting",children:"Troubleshooting"}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"Player falls through platforms"}),": Check that platform physics bodies are created correctly and collision detection is properly set up."]}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"Jumping doesn't work"}),": Verify that ground detection is working and the contact listener is properly registered."]}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"Jittery movement"}),": Adjust physics timestep or add damping to the player's physics body."]}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"Player sticks to walls"}),": Reduce friction between player and platforms, or adjust the collision normal detection logic."]}),"\n",(0,n.jsx)(t.h2,{id:"next-steps",children:"Next Steps"}),"\n",(0,n.jsxs)(t.p,{children:["In ",(0,n.jsx)(t.a,{href:"./part-5-mechanics",children:"Part 5: Game Mechanics"}),", we'll add collectible items, a scoring system, and UI elements to make our platformer more engaging."]}),"\n",(0,n.jsx)(t.h2,{id:"complete-code-reference",children:"Complete Code Reference"}),"\n",(0,n.jsxs)(t.p,{children:["You can find the complete code for this part in the ",(0,n.jsx)(t.a,{href:"https://github.com/brandmooffin/cocos2d-mono-samples/tree/main/Tutorial%20Samples/Platformer/Checkpoints/Part%204",children:"tutorial samples repository"}),"."]})]})}function p(e={}){const{wrapper:t}={...(0,o.RP)(),...e.components};return t?(0,n.jsx)(t,{...e,children:(0,n.jsx)(d,{...e})}):d(e)}},28453:(e,t,r)=>{r.d(t,{RP:()=>l});var n=r(96540);const o=n.createContext({});function l(e){const t=n.useContext(o);return n.useMemo(()=>"function"==typeof e?e(t):{...t,...e},[t,e])}}}]);